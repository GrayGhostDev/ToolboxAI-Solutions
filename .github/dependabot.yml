version: 2

# ============================================
# TOOLBOXAI DEPENDABOT CONFIGURATION - 2025
# ============================================
# Automated dependency updates with:
# - Grouped updates for related packages
# - Staggered schedules across the week
# - Auto-labeling for easier triage
# - Enhanced security and versioning strategies
# - Rebase and auto-merge capabilities
# ============================================
# Last Updated: 2025-11-09
# ============================================

updates:
  # ──────────────────────────────────────────
  # PYTHON DEPENDENCIES (Backend)
  # ──────────────────────────────────────────
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "America/New_York"
    open-pull-requests-limit: 10
    reviewers:
      - "GrayGhostDev"
    assignees:
      - "GrayGhostDev"
    commit-message:
      prefix: "chore(deps)"
      prefix-development: "chore(deps)"
      include: "scope"
    labels:
      - "dependencies"
      - "python"
      - "backend"
      - "automated"
    pull-request-branch-name:
      separator: "/"
    versioning-strategy: increase
    rebase-strategy: auto
    allow:
      - dependency-type: "all"
    # Group related dependencies together
    groups:
      fastapi-ecosystem:
        patterns:
          - "fastapi*"
          - "uvicorn*"
          - "starlette*"
          - "pydantic*"
        update-types:
          - "minor"
          - "patch"
      testing:
        patterns:
          - "pytest*"
          - "coverage*"
        update-types:
          - "minor"
          - "patch"
      security:
        patterns:
          - "cryptography*"
          - "bcrypt*"
          - "passlib*"
          - "pyjwt*"
        update-types:
          - "minor"
          - "patch"
      ai-ml:
        patterns:
          - "langchain*"
          - "openai*"
          - "tiktoken*"
        update-types:
          - "minor"
          - "patch"
      database:
        patterns:
          - "sqlalchemy*"
          - "alembic*"
          - "asyncpg*"
          - "psycopg*"
        update-types:
          - "minor"
          - "patch"

  # Node.js dependencies (root)
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "10:00"
      timezone: "America/New_York"
    open-pull-requests-limit: 5
    reviewers:
      - "GrayGhostDev"
    assignees:
      - "GrayGhostDev"
    commit-message:
      prefix: "chore(deps)"
      include: "scope"
    labels:
      - "dependencies"
      - "javascript"
      - "automated"
    versioning-strategy: increase
    rebase-strategy: auto
    allow:
      - dependency-type: "all"

  # ──────────────────────────────────────────
  # NPM DEPENDENCIES (Dashboard)
  # ──────────────────────────────────────────
  - package-ecosystem: "npm"
    directory: "/apps/dashboard"
    schedule:
      interval: "weekly"
      day: "tuesday"
      time: "10:00"
      timezone: "America/New_York"
    open-pull-requests-limit: 10
    reviewers:
      - "GrayGhostDev"
    assignees:
      - "GrayGhostDev"
    commit-message:
      prefix: "chore(deps)"
      prefix-development: "chore(deps)"
      include: "scope"
    labels:
      - "dependencies"
      - "javascript"
      - "frontend"
      - "dashboard"
      - "automated"
    pull-request-branch-name:
      separator: "/"
    versioning-strategy: increase
    rebase-strategy: auto
    allow:
      - dependency-type: "all"
    # Group updates by framework
    groups:
      react-ecosystem:
        patterns:
          - "react"
          - "react-dom"
          - "react-router*"
          - "@types/react*"
        update-types:
          - "minor"
          - "patch"
      mantine-ui:
        patterns:
          - "@mantine/*"
        update-types:
          - "minor"
          - "patch"
      vite-ecosystem:
        patterns:
          - "vite*"
          - "@vitejs/*"
        update-types:
          - "minor"
          - "patch"
      testing:
        patterns:
          - "vitest*"
          - "@vitest/*"
          - "playwright*"
          - "@playwright/*"
          - "@testing-library/*"
        update-types:
          - "minor"
          - "patch"
      typescript:
        patterns:
          - "typescript"
          - "@types/*"
        update-types:
          - "minor"
          - "patch"
      linting:
        patterns:
          - "eslint*"
          - "@typescript-eslint/*"
          - "prettier*"
        update-types:
          - "minor"
          - "patch"

  # ──────────────────────────────────────────
  # GITHUB ACTIONS
  # ──────────────────────────────────────────
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "wednesday"
      time: "09:00"
      timezone: "America/New_York"
    open-pull-requests-limit: 10
    reviewers:
      - "GrayGhostDev"
    assignees:
      - "GrayGhostDev"
    commit-message:
      prefix: "chore(actions)"
      include: "scope"
    labels:
      - "dependencies"
      - "github-actions"
      - "ci-cd"
      - "automated"
    pull-request-branch-name:
      separator: "/"
    rebase-strategy: auto
    # Group action updates by vendor
    groups:
      actions-core:
        patterns:
          - "actions/*"
        update-types:
          - "minor"
          - "patch"
      docker-actions:
        patterns:
          - "docker/*"
        update-types:
          - "minor"
          - "patch"
      security-actions:
        patterns:
          - "aquasecurity/*"
          - "github/codeql-action/*"
          - "anchore/*"
          - "trufflesecurity/*"
          - "reviewdog/*"
          - "gitleaks/*"
        update-types:
          - "minor"
          - "patch"
      deployment-actions:
        patterns:
          - "vercel/*"
          - "superfly/*"
        update-types:
          - "minor"
          - "patch"

  # ──────────────────────────────────────────
  # DOCKER DEPENDENCIES
  # ──────────────────────────────────────────
  - package-ecosystem: "docker"
    directory: "/infrastructure/docker"
    schedule:
      interval: "weekly"
      day: "thursday"
      time: "09:00"
      timezone: "America/New_York"
    open-pull-requests-limit: 5
    reviewers:
      - "GrayGhostDev"
    assignees:
      - "GrayGhostDev"
    commit-message:
      prefix: "chore(docker)"
      include: "scope"
    labels:
      - "dependencies"
      - "docker"
      - "infrastructure"
      - "automated"
    rebase-strategy: auto

  - package-ecosystem: "docker"
    directory: "/apps/backend"
    schedule:
      interval: "weekly"
      day: "thursday"
      time: "10:00"
      timezone: "America/New_York"
    open-pull-requests-limit: 3
    reviewers:
      - "GrayGhostDev"
    commit-message:
      prefix: "chore(docker)"
      include: "scope"
    labels:
      - "dependencies"
      - "docker"
      - "backend"
      - "automated"
    rebase-strategy: auto

  - package-ecosystem: "docker"
    directory: "/apps/dashboard"
    schedule:
      interval: "weekly"
      day: "thursday"
      time: "11:00"
      timezone: "America/New_York"
    open-pull-requests-limit: 3
    reviewers:
      - "GrayGhostDev"
    commit-message:
      prefix: "chore(docker)"
      include: "scope"
    labels:
      - "dependencies"
      - "docker"
      - "dashboard"
      - "automated"
    rebase-strategy: auto

# ============================================
# NOTES - 2025 Best Practices
# ============================================
#
# Staggered Schedule:
#   Monday    - Python dependencies (9:00 AM) & Root npm (10:00 AM)
#   Tuesday   - Dashboard npm (10:00 AM)
#   Wednesday - GitHub Actions (9:00 AM)
#   Thursday  - Docker images (9:00, 10:00, 11:00 AM)
#
# Dependency Grouping:
#   Related packages are grouped together in single PRs
#   to reduce noise and make reviews more efficient.
#   Groups only include minor and patch updates.
#
# Security Updates:
#   Dependabot automatically creates PRs for security updates
#   regardless of schedule. Review and merge these ASAP.
#   Security updates are NEVER grouped.
#
# Versioning Strategy:
#   - increase: Bump version even if appears to be "satisfied"
#   - Ensures latest compatible versions are installed
#
# Rebase Strategy:
#   - auto: Automatically rebase PRs when base branch changes
#   - Keeps PRs up to date with main branch
#
# Update Types in Groups:
#   - minor: Feature updates (1.x.0 -> 1.y.0)
#   - patch: Bug fixes (1.0.x -> 1.0.y)
#   - Major updates create separate PRs for review
#
# Auto-merge (Optional - Configure in Settings):
#   1. Go to Settings > Code security and analysis
#   2. Enable "Dependabot security updates"
#   3. Configure branch protection rules
#   4. Enable auto-merge for:
#      - Patch version updates
#      - Development dependencies
#      - Security updates (after CI passes)
#
# Best Practices:
#   - Review and merge dependency PRs weekly
#   - Security updates should be merged within 24-48 hours
#   - Test thoroughly after merging groups of dependencies
#   - Monitor CI/CD pipelines for breaking changes
#   - Keep dependencies up to date to reduce technical debt
#
# Monitoring:
#   - Check Insights > Dependency graph > Dependabot
#   - Review security alerts: Security > Dependabot alerts
#   - Track update history in Pull Requests
#
# ============================================
