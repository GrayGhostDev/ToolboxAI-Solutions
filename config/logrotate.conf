# Logrotate configuration for ToolBoxAI Solutions
# This file should be copied to /etc/logrotate.d/toolboxai or included in the system's logrotate configuration
#
# For macOS users: Install logrotate via Homebrew: brew install logrotate
# For Linux users: logrotate is usually pre-installed
#
# Usage:
# - Test configuration: logrotate -d /path/to/this/logrotate.conf
# - Force rotation: logrotate -f /path/to/this/logrotate.conf
# - Add to cron: Add to /etc/cron.daily/ or configure in crontab

# Application logs
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/*.log {
    # Rotate daily
    daily

    # Keep 30 days of logs
    rotate 30

    # Compress old logs
    compress
    delaycompress

    # Don't rotate empty logs
    notifempty

    # Create new log files with specific permissions
    create 0644 root root

    # Rotate when file exceeds 100MB
    maxsize 100M

    # Continue if log file is missing
    missingok

    # Use date as extension for rotated files
    dateext
    dateformat -%Y%m%d

    # Run script after rotation
    sharedscripts
    postrotate
        # Send signal to application to reopen log files if needed
        # Uncomment and adjust if your application needs notification
        # /bin/kill -USR1 `cat /var/run/toolboxai.pid 2>/dev/null` 2>/dev/null || true
    endscript
}

# Test logs (more aggressive rotation)
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/tests/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    notifempty
    create 0644 root root
    maxsize 50M
    missingok
    dateext
    dateformat -%Y%m%d
}

# Pytest logs
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/tests/logs/pytest_run.log {
    daily
    rotate 3
    compress
    notifempty
    create 0644 root root
    maxsize 10M
    missingok
    dateext
    dateformat -%Y%m%d
}

# Backend error logs
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/*_errors.log {
    daily
    rotate 30
    compress
    delaycompress
    notifempty
    create 0644 root root
    maxsize 50M
    missingok
    dateext
    dateformat -%Y%m%d

    # Email critical errors (configure mail settings first)
    # mail admin@toolboxai.com
    # mailfirst
}

# Access logs
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/*_access.log {
    daily
    rotate 14
    compress
    delaycompress
    notifempty
    create 0644 root root
    maxsize 200M
    missingok
    dateext
    dateformat -%Y%m%d
}