# Redis 7 ACL Configuration File
# Enhanced Access Control Lists with key permissions and command categories

# =============================================================================
# Default User (Disabled for Security)
# =============================================================================
user default off

# =============================================================================
# Administrative Users
# =============================================================================

# System Administrator - Full access
user admin on >admin_secure_password_2024! ~* +@all

# Database Administrator - Database operations only
user dba on >dba_secure_password_2024! ~* +@read +@write +@keyspace +@connection +info +config +client +memory +latency -@dangerous

# Backup User - Read-only access for backups
user backup on >backup_secure_password_2024! ~* +@read +ping +info +select +scan +keys +exists +type +ttl +dump +restore

# =============================================================================
# Application Users
# =============================================================================

# Main Application User - Standard operations
user app_main on >app_main_secure_password_2024! ~app:* ~session:* ~cache:* +@read +@write +@list +@set +@hash +@stream +@bitmap +@hyperloglog +@geo +ping +info +select +multi +exec +discard +watch +unwatch

# API Gateway User - Rate limiting and caching
user api_gateway on >api_gateway_secure_password_2024! ~api:* ~rate:* ~quota:* +get +set +incr +decr +incrby +decrby +expire +ttl +exists +del +mget +mset +ping

# Session Manager User - Session storage
user session_mgr on >session_secure_password_2024! ~session:* ~user:* +@hash +@string +get +set +del +exists +expire +ttl +ping +select

# Cache User - Caching operations
user cache_user on >cache_secure_password_2024! ~cache:* ~temp:* +get +set +del +mget +mset +exists +expire +ttl +ping +select +flushdb

# =============================================================================
# Analytics and Monitoring Users
# =============================================================================

# Analytics User - Read-only access to analytics data
user analytics on >analytics_secure_password_2024! ~analytics:* ~metrics:* ~stats:* +@read +ping +info +select +scan

# Monitoring User - System monitoring
user monitor on >monitor_secure_password_2024! ~* +info +ping +client +memory +stats +slowlog +latency +config|get -config|set +scan +dbsize +lastsave

# Metrics Collector - Performance metrics
user metrics on >metrics_secure_password_2024! ~metrics:* ~perf:* +@read +@write +ping +info +select +scan +monitor

# =============================================================================
# Pub/Sub Users (Redis 7 Sharded Pub/Sub)
# =============================================================================

# Event Publisher - Publish events
user event_publisher on >event_pub_secure_password_2024! ~* +ping +publish +spublish +pubsub resetchannels &events:* &notifications:* &alerts:*

# Event Subscriber - Subscribe to events
user event_subscriber on >event_sub_secure_password_2024! ~* +ping +subscribe +psubscribe +unsubscribe +punsubscribe +ssubscribe +sunsubscribe +pubsub resetchannels &events:* &notifications:* &alerts:*

# Notification Service - Bidirectional pub/sub
user notification_svc on >notif_secure_password_2024! ~notification:* +ping +publish +spublish +subscribe +psubscribe +ssubscribe +unsubscribe +punsubscribe +sunsubscribe +pubsub resetchannels &notifications:* &alerts:* &system:*

# =============================================================================
# Microservice Users
# =============================================================================

# User Service - User-related operations
user user_service on >user_svc_secure_password_2024! ~user:* ~profile:* ~auth:* +@hash +@string +@set +get +set +del +exists +expire +ttl +ping +select +multi +exec

# Order Service - Order processing
user order_service on >order_svc_secure_password_2024! ~order:* ~cart:* ~inventory:* +@hash +@list +@string +@sorted_set +get +set +del +exists +expire +ttl +ping +select +multi +exec +watch

# Payment Service - Payment processing (high security)
user payment_service on >payment_svc_ultra_secure_password_2024! ~payment:* ~transaction:* +@hash +@string +get +set +del +exists +expire +ttl +ping +select +multi +exec +watch -@dangerous

# Inventory Service - Inventory management
user inventory_service on >inventory_svc_secure_password_2024! ~inventory:* ~product:* ~stock:* +@hash +@string +@sorted_set +get +set +del +exists +expire +ttl +ping +select +multi +exec +incr +decr +incrby +decrby

# =============================================================================
# Queue and Job Processing Users
# =============================================================================

# Job Queue Publisher - Add jobs to queues
user job_publisher on >job_pub_secure_password_2024! ~job:* ~queue:* ~task:* +@list +@stream +lpush +rpush +lpop +rpop +llen +lrange +ping +select +xadd +xread +xlen

# Job Queue Consumer - Process jobs from queues
user job_consumer on >job_con_secure_password_2024! ~job:* ~queue:* ~task:* +@list +@stream +@hash +lpush +rpush +lpop +rpop +llen +lrange +ping +select +xadd +xread +xreadgroup +xack +xpending +get +set +del

# Scheduler Service - Delayed job scheduling
user scheduler on >scheduler_secure_password_2024! ~schedule:* ~delayed:* ~cron:* +@sorted_set +@hash +@string +zadd +zrem +zrange +zrangebyscore +zremrangebyscore +get +set +del +exists +expire +ping +select

# =============================================================================
# Development and Testing Users (Lower Security)
# =============================================================================

# Developer User - Development environment access
user developer on >dev_password_123! ~dev:* ~test:* ~temp:* +@all -@dangerous -flushall -flushdb -shutdown -debug -config

# Test User - Automated testing
user test_user on >test_password_123! ~test:* ~mock:* +@all -@dangerous -flushall -flushdb -shutdown -debug -config

# =============================================================================
# Integration Users
# =============================================================================

# ETL Service - Data extraction and loading
user etl_service on >etl_secure_password_2024! ~etl:* ~staging:* ~import:* +@read +@write +@hash +@list +@set +@sorted_set +ping +select +scan +multi +exec

# Search Index Service - Search functionality
user search_service on >search_secure_password_2024! ~search:* ~index:* ~autocomplete:* +@read +@write +@string +@set +@sorted_set +@hash +ping +select

# Logging Service - Log aggregation
user logging_service on >logging_secure_password_2024! ~log:* ~audit:* +@list +@stream +@hash +lpush +rpush +llen +ltrim +ping +select +xadd +xlen +xtrim

# =============================================================================
# External Service Users
# =============================================================================

# CDN Cache User - Content delivery network
user cdn_cache on >cdn_secure_password_2024! ~cdn:* ~static:* ~asset:* +get +set +del +exists +expire +ttl +ping +select +mget +mset

# Load Balancer - Health checks and routing
user loadbalancer on >lb_secure_password_2024! ~health:* ~routing:* +ping +info +get +set +exists +expire +ttl +select

# =============================================================================
# ACL Categories Reference
# =============================================================================
# @read - Read commands (get, hget, lrange, etc.)
# @write - Write commands (set, hset, lpush, etc.)
# @keyspace - Keyspace commands (del, exists, expire, etc.)
# @string - String commands
# @list - List commands
# @set - Set commands
# @sorted_set - Sorted set commands
# @hash - Hash commands
# @bitmap - Bitmap commands
# @hyperloglog - HyperLogLog commands
# @geo - Geo commands
# @stream - Stream commands
# @pubsub - Pub/sub commands
# @admin - Administrative commands
# @fast - Fast commands
# @slow - Slow commands
# @blocking - Blocking commands
# @dangerous - Dangerous commands (flushall, flushdb, etc.)
# @connection - Connection commands
# @transaction - Transaction commands
# @scripting - Scripting commands

# =============================================================================
# Key Pattern Examples
# =============================================================================
# ~* - All keys
# ~app:* - Keys starting with "app:"
# ~user:1001:* - Keys for specific user
# ~cache:session:* - Session cache keys
# ~!sensitive:* - All keys except those starting with "sensitive:"

# =============================================================================
# Channel Pattern Examples (Pub/Sub)
# =============================================================================
# &* - All channels
# &notifications:* - Notification channels
# &events:user:* - User event channels
# &!admin:* - All channels except admin channels

# =============================================================================
# Security Best Practices
# =============================================================================
# 1. Use strong, unique passwords for each user
# 2. Limit key access patterns to minimum required
# 3. Use specific command categories instead of +@all
# 4. Regularly rotate passwords
# 5. Monitor access patterns and failed authentication attempts
# 6. Use TLS for connections in production
# 7. Implement IP-based access controls at network level
# 8. Regular ACL audits and reviews