# Git-secrets patterns to prevent credential leaks
# To use: install git-secrets and run: git secrets --install

# API Key Patterns
sk-[a-zA-Z0-9]{48}  # OpenAI API keys
anthropic-[a-zA-Z0-9]{32}  # Anthropic keys
AIza[0-9A-Za-z\\-_]{35}  # Google API keys
AKIA[0-9A-Z]{16}  # AWS Access Key IDs

# Database Patterns
postgres(ql)?://[^:]+:[^@]+@  # PostgreSQL URLs with passwords
mysql://[^:]+:[^@]+@  # MySQL URLs with passwords
mongodb(\+srv)?://[^:]+:[^@]+@  # MongoDB URLs with passwords

# JWT and Secret Keys
jwt[_-]?secret[_-]?key['\"]?\s*[:=]\s*['\"][^'\"]+['\"]  # JWT secrets
secret[_-]?key['\"]?\s*[:=]\s*['\"][^'\"]+['\"]  # Generic secret keys

# Pusher Credentials
pusher[_-]?secret['\"]?\s*[:=]\s*['\"][a-f0-9]{20}['\"]  # Pusher secrets
pusher[_-]?key['\"]?\s*[:=]\s*['\"][a-f0-9]{20}['\"]  # Pusher keys

# Supabase Patterns
eyJ[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*  # JWT tokens (Supabase keys)
sb[a-z]{2}[a-z]{2}[a-z]{16}  # Supabase project IDs

# Clerk Patterns
clerk[_-]?secret[_-]?key['\"]?\s*[:=]\s*['\"][^'\"]+['\"]  # Clerk secrets

# Password Patterns
password['\"]?\s*[:=]\s*['\"][^'\"]{8,}['\"]  # Generic passwords
pass['\"]?\s*[:=]\s*['\"][^'\"]{8,}['\"]  # Short form passwords

# Private Keys
-----BEGIN (RSA|DSA|EC|OPENSSH|PGP) PRIVATE KEY-----  # Private keys
-----BEGIN ENCRYPTED PRIVATE KEY-----  # Encrypted private keys

# Webhook Secrets
webhook[_-]?secret['\"]?\s*[:=]\s*['\"][^'\"]+['\"]  # Webhook secrets

# Stripe
sk_live_[0-9a-zA-Z]{24,}  # Stripe live secret keys
rk_live_[0-9a-zA-Z]{24,}  # Stripe restricted keys

# GitHub
ghp_[0-9a-zA-Z]{36}  # GitHub personal access tokens
ghs_[0-9a-zA-Z]{36}  # GitHub secret scanning tokens

# Slack
xox[baprs]-[0-9a-zA-Z]{10,48}  # Slack tokens

# Custom Patterns for ToolBoxAI
eduplatform2024  # Default dev password - should never be committed
487b104d996aaa9ef148  # Exposed Pusher key
45e89fd91f50fe615235  # Exposed Pusher secret
casual-firefly-39  # Exposed Clerk URL

# Allowed Patterns (whitelist)
# Add patterns here that are safe to commit
# Example: test-jwt-secret-key-only-for-testing