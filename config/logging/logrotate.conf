# ToolBoxAI Solutions - Unified Log Rotation Configuration
# This file should be copied to /etc/logrotate.d/toolboxai or included in the system's logrotate configuration
#
# For macOS users: Install logrotate via Homebrew: brew install logrotate
# For Linux users: logrotate is usually pre-installed
#
# Usage:
# - Test configuration: logrotate -d /path/to/this/logrotate_unified.conf
# - Force rotation: logrotate -f /path/to/this/logrotate_unified.conf
# - Add to cron: Add to /etc/cron.daily/ or configure in crontab

# Application logs - Daily rotation with 30-day retention
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/**/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    create 644 grayghostdata staff
    copytruncate
    dateext
    dateformat -%Y%m%d

    # Size-based rotation trigger (rotate if larger than 100MB)
    size 100M

    # Post-rotation script
    postrotate
        # Send SIGUSR1 to applications to reopen log files if needed
        # This is optional and depends on your application's implementation
        # killall -USR1 python3 2>/dev/null || true
    endscript
}

# Output files - Weekly rotation with 7-day retention
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/**/*.out {
    weekly
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 644 grayghostdata staff
    copytruncate
    dateext
}

# Error logs - Daily rotation with 60-day retention
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/**/*.err
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/**/error*.log {
    daily
    rotate 60
    compress
    delaycompress
    missingok
    notifempty
    create 644 grayghostdata staff
    copytruncate
    dateext
}

# JSON monitoring files - Monthly rotation with 1-year retention
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/**/*.json {
    monthly
    rotate 12
    compress
    delaycompress
    missingok
    notifempty
    create 644 grayghostdata staff
    copytruncate
    dateext
}

# Clean up PID files (remove without rotation)
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/**/*.pid {
    daily
    rotate 0
    missingok
    notifempty
}

# Docker container logs (if applicable)
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/docker/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    create 644 grayghostdata staff
    copytruncate
    maxage 30
}

# Audit logs - Special handling for compliance
/Volumes/G-DRIVE\ ArmorATD/Development/Clients/ToolBoxAI-Solutions/logs/audit/*.log {
    daily
    rotate 365
    compress
    delaycompress
    missingok
    notifempty
    create 600 grayghostdata staff
    copytruncate
    dateext
    # Audit logs kept for 1 year for compliance
}