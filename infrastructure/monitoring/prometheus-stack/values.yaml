# Prometheus Stack Helm Values for ToolBoxAI Solutions
# Production-ready monitoring with security and compliance

global:
  rbac:
    create: true

prometheus:
  enabled: true
  prometheusSpec:
    replicas: 2
    retention: 30d
    retentionSize: 50GB

    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      fsGroup: 2000

    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: gp3-encrypted
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 100Gi

    resources:
      requests:
        cpu: 500m
        memory: 2Gi
      limits:
        cpu: 2000m
        memory: 8Gi

    serviceMonitorSelector:
      matchLabels:
        monitoring: prometheus

    externalLabels:
      cluster: toolboxai-prod
      environment: production
      compliance: coppa-ferpa-gdpr

alertmanager:
  enabled: true
  alertmanagerSpec:
    replicas: 3
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      fsGroup: 2000
    storage:
      volumeClaimTemplate:
        spec:
          storageClassName: gp3-encrypted
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 10Gi
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

  config:
    global:
      resolve_timeout: 5m
    route:
      group_by: ['alertname', 'cluster', 'service']
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 12h
      receiver: 'default'
      routes:
        - match:
            severity: critical
          receiver: pagerduty
        - match:
            category: security
          receiver: security-team
        - match:
            compliance: required
          receiver: compliance-team
    receivers:
      - name: 'default'
        email_configs:
          - to: 'ops@toolboxai.solutions'
      - name: 'pagerduty'
        pagerduty_configs:
          - service_key: '${PAGERDUTY_KEY}'
      - name: 'security-team'
        email_configs:
          - to: 'security@toolboxai.solutions'
      - name: 'compliance-team'
        email_configs:
          - to: 'compliance@toolboxai.solutions'

grafana:
  enabled: true
  adminUser: admin
  persistence:
    enabled: true
    storageClassName: gp3-encrypted
    size: 10Gi
  securityContext:
    runAsNonRoot: true
    runAsUser: 472
    fsGroup: 472
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi