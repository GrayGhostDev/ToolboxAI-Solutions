# ConfigMaps and Secrets for MCP-Agent Platform
apiVersion: v1
kind: ConfigMap
metadata:
  name: mcp-config
  namespace: mcp-platform
  labels:
    app: mcp-platform
    component: configuration
data:
  LOG_LEVEL: "info"
  ENVIRONMENT: "production"
  MCP_HOST: "0.0.0.0"
  MCP_PORT: "9876"
  MCP_METRICS_PORT: "9090"
  MCP_REGISTRY_TTL: "300"
  MCP_TASK_TIMEOUT: "600"
  MCP_MAX_CONCURRENT_TASKS: "50"
  AGENT_DISCOVERY_ENABLED: "true"
  REDIS_HOST: "redis-service.default.svc.cluster.local"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  DATABASE_HOST: "postgres-service.default.svc.cluster.local"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "educational_platform"
  DATABASE_USER: "toolboxai_user"
  PROMETHEUS_ENABLED: "true"
  METRICS_ENABLED: "true"
  TRACING_ENABLED: "true"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: mcp-server-config
  namespace: mcp-platform
  labels:
    app: mcp-server
    component: configuration
data:
  servers.json: |
    {
      "mcpServers": {
        "orchestrator": {
          "name": "ToolboxAI-Orchestrator-Server",
          "type": "orchestrator",
          "version": "1.0.0",
          "configuration": {
            "host": "0.0.0.0",
            "port": 9877,
            "protocol": "websocket",
            "capabilities": {
              "taskTypes": [
                "content-generation",
                "quiz-creation",
                "terrain-generation",
                "script-generation",
                "content-review",
                "orchestration",
                "database-management",
                "github-integration"
              ],
              "maxConcurrentTasks": 50,
              "taskQueueSize": 1000
            }
          }
        }
      }
    }

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: agent-coordinator-config
  namespace: mcp-platform
  labels:
    app: agent-coordinator
    component: configuration
data:
  COORDINATOR_PORT: "8888"
  MAX_CONCURRENT_AGENTS: "10"
  AGENT_HEALTH_CHECK_INTERVAL: "30"
  AGENT_REGISTRATION_INTERVAL: "60"
  TASK_TIMEOUT: "600"
  LOG_LEVEL: "info"
  REDIS_HOST: "redis-service.default.svc.cluster.local"
  REDIS_PORT: "6379"
  DATABASE_HOST: "postgres-service.default.svc.cluster.local"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "educational_platform"
  DATABASE_USER: "toolboxai_user"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: educational-agents-config
  namespace: mcp-platform
  labels:
    app: educational-agents
    component: configuration
data:
  AGENT_TYPE: "educational"
  AGENT_POOL_SIZE: "3"
  AGENT_PORT: "8080"
  REGISTRATION_INTERVAL: "60"
  TASK_BATCH_SIZE: "5"
  MAX_TOKENS: "4096"
  TEMPERATURE: "0.7"
  MODEL: "gpt-4-turbo-preview"
  REDIS_HOST: "redis-service.default.svc.cluster.local"
  REDIS_PORT: "6379"
  DATABASE_HOST: "postgres-service.default.svc.cluster.local"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "educational_platform"
  DATABASE_USER: "toolboxai_user"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: github-agents-config
  namespace: mcp-platform
  labels:
    app: github-agents
    component: configuration
data:
  AGENT_TYPE: "github"
  AGENT_POOL_SIZE: "2"
  AGENT_PORT: "8080"
  REGISTRATION_INTERVAL: "60"
  GITHUB_API_BASE_URL: "https://api.github.com"
  REDIS_HOST: "redis-service.default.svc.cluster.local"
  REDIS_PORT: "6379"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: database-agents-config
  namespace: mcp-platform
  labels:
    app: database-agents
    component: configuration
data:
  AGENT_TYPE: "database"
  AGENT_POOL_SIZE: "2"
  AGENT_PORT: "8080"
  REGISTRATION_INTERVAL: "60"
  BACKUP_SCHEDULE: "0 2 * * *"
  AWS_REGION: "us-east-1"
  REDIS_HOST: "redis-service.default.svc.cluster.local"
  REDIS_PORT: "6379"
  DATABASE_HOST: "postgres-service.default.svc.cluster.local"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "educational_platform"
  DATABASE_USER: "toolboxai_user"

---
# Secrets (Base64 encoded values - replace with actual secrets)
apiVersion: v1
kind: Secret
metadata:
  name: mcp-secrets
  namespace: mcp-platform
  labels:
    app: mcp-platform
    component: secrets
type: Opaque
data:
  JWT_SECRET_KEY: # Base64 encoded JWT secret
  REDIS_PASSWORD: # Base64 encoded Redis password
  DATABASE_PASSWORD: # Base64 encoded database password

---
apiVersion: v1
kind: Secret
metadata:
  name: agent-coordinator-secrets
  namespace: mcp-platform
  labels:
    app: agent-coordinator
    component: secrets
type: Opaque
data:
  JWT_SECRET_KEY: # Base64 encoded JWT secret
  REDIS_PASSWORD: # Base64 encoded Redis password
  DATABASE_PASSWORD: # Base64 encoded database password
  OPENAI_API_KEY: # Base64 encoded OpenAI API key

---
apiVersion: v1
kind: Secret
metadata:
  name: educational-agents-secrets
  namespace: mcp-platform
  labels:
    app: educational-agents
    component: secrets
type: Opaque
data:
  REDIS_PASSWORD: # Base64 encoded Redis password
  DATABASE_PASSWORD: # Base64 encoded database password
  OPENAI_API_KEY: # Base64 encoded OpenAI API key

---
apiVersion: v1
kind: Secret
metadata:
  name: github-agents-secrets
  namespace: mcp-platform
  labels:
    app: github-agents
    component: secrets
type: Opaque
data:
  REDIS_PASSWORD: # Base64 encoded Redis password
  GITHUB_TOKEN: # Base64 encoded GitHub token
  GITHUB_WEBHOOK_SECRET: # Base64 encoded GitHub webhook secret

---
apiVersion: v1
kind: Secret
metadata:
  name: database-agents-secrets
  namespace: mcp-platform
  labels:
    app: database-agents
    component: secrets
type: Opaque
data:
  REDIS_PASSWORD: # Base64 encoded Redis password
  DATABASE_PASSWORD: # Base64 encoded database password
  AWS_ACCESS_KEY_ID: # Base64 encoded AWS access key
  AWS_SECRET_ACCESS_KEY: # Base64 encoded AWS secret key
  BACKUP_S3_BUCKET: # Base64 encoded S3 bucket name

---
# Service Accounts
apiVersion: v1
kind: ServiceAccount
metadata:
  name: mcp-server-sa
  namespace: mcp-platform
  labels:
    app: mcp-server
    component: rbac
automountServiceAccountToken: true

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: agent-coordinator-sa
  namespace: mcp-platform
  labels:
    app: agent-coordinator
    component: rbac
automountServiceAccountToken: true

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: agent-pool-sa
  namespace: mcp-platform
  labels:
    app: agent-pools
    component: rbac
automountServiceAccountToken: true

---
# RBAC ClusterRoles
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: mcp-server-role
  labels:
    app: mcp-platform
    component: rbac
rules:
- apiGroups: [""]
  resources: ["pods", "services", "configmaps", "secrets"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["metrics.k8s.io"]
  resources: ["pods", "nodes"]
  verbs: ["get", "list"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: agent-coordinator-role
  labels:
    app: mcp-platform
    component: rbac
rules:
- apiGroups: [""]
  resources: ["pods", "services", "configmaps"]
  verbs: ["get", "list", "watch", "create", "update", "patch"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets"]
  verbs: ["get", "list", "watch", "create", "update", "patch"]
- apiGroups: ["autoscaling"]
  resources: ["horizontalpodautoscalers"]
  verbs: ["get", "list", "watch", "create", "update", "patch"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: agent-pool-role
  labels:
    app: mcp-platform
    component: rbac
rules:
- apiGroups: [""]
  resources: ["pods", "services", "configmaps"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets"]
  verbs: ["get", "list", "watch"]

---
# RBAC ClusterRoleBindings
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: mcp-server-binding
  labels:
    app: mcp-platform
    component: rbac
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: mcp-server-role
subjects:
- kind: ServiceAccount
  name: mcp-server-sa
  namespace: mcp-platform

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: agent-coordinator-binding
  labels:
    app: mcp-platform
    component: rbac
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: agent-coordinator-role
subjects:
- kind: ServiceAccount
  name: agent-coordinator-sa
  namespace: mcp-platform

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: agent-pool-binding
  labels:
    app: mcp-platform
    component: rbac
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: agent-pool-role
subjects:
- kind: ServiceAccount
  name: agent-pool-sa
  namespace: mcp-platform

---
# Persistent Volume Claims
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: agent-data-pvc
  namespace: mcp-platform
  labels:
    app: mcp-platform
    component: storage
spec:
  accessModes:
    - ReadWriteMany
  storageClassName: gp3-encrypted
  resources:
    requests:
      storage: 20Gi

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: educational-content-pvc
  namespace: mcp-platform
  labels:
    app: educational-agents
    component: storage
spec:
  accessModes:
    - ReadWriteMany
  storageClassName: gp3-encrypted
  resources:
    requests:
      storage: 50Gi

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: github-cache-pvc
  namespace: mcp-platform
  labels:
    app: github-agents
    component: storage
spec:
  accessModes:
    - ReadWriteMany
  storageClassName: gp3-encrypted
  resources:
    requests:
      storage: 10Gi

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: backup-storage-pvc
  namespace: mcp-platform
  labels:
    app: database-agents
    component: storage
spec:
  accessModes:
    - ReadWriteMany
  storageClassName: gp3-encrypted
  resources:
    requests:
      storage: 100Gi

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: logs-pvc
  namespace: mcp-platform
  labels:
    app: mcp-platform
    component: logging
spec:
  accessModes:
    - ReadWriteMany
  storageClassName: gp3-encrypted
  resources:
    requests:
      storage: 20Gi