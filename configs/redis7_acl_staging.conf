# Redis 7 Access Control List (ACL) Configuration for Staging
# Defines user permissions and access controls
# September 2024

# =============================================================================
# DEFAULT USER (disabled for security)
# =============================================================================
user default off

# =============================================================================
# ADMIN USER (full access)
# =============================================================================
user admin on >staging_admin_password_2024 ~* &* +@all

# =============================================================================
# APPLICATION USER (limited access for app connections)
# =============================================================================
user toolboxai_app on >staging_redis7_password_2024 ~* -@dangerous +@read +@write +@string +@hash +@list +@set +@sortedset +@stream +@connection +@transaction

# =============================================================================
# MONITORING USER (read-only for metrics collection)
# =============================================================================
user monitoring on >staging_monitor_password_2024 ~* +@read +info +ping +client +config +memory +latency +slowlog

# =============================================================================
# BACKUP USER (limited to persistence commands)
# =============================================================================
user backup on >staging_backup_password_2024 ~* +@read +bgsave +lastsave +info

# =============================================================================
# CACHE USER (specific for caching operations)
# =============================================================================
user cache_user on >staging_cache_password_2024 ~cache:* +@read +@write +@string +@hash +expire +ttl +exists +del

# =============================================================================
# SESSION USER (specific for session management)
# =============================================================================
user session_user on >staging_session_password_2024 ~session:* ~user:* +@read +@write +@string +@hash +expire +ttl +exists +del

# =============================================================================
# PUBSUB USER (for real-time messaging)
# =============================================================================
user pubsub_user on >staging_pubsub_password_2024 ~* +@read +@pubsub +subscribe +unsubscribe +publish +ping

# =============================================================================
# RATE_LIMIT USER (for rate limiting operations)
# =============================================================================
user rate_limit_user on >staging_ratelimit_password_2024 ~rate_limit:* ~counter:* +@read +@write +@string +incr +decr +expire +ttl

# =============================================================================
# TEST USER (for staging tests)
# =============================================================================
user test_user on >staging_test_password_2024 ~test:* +@all

# =============================================================================
# REPLICATION USER (for Redis replication if needed)
# =============================================================================
user replicator on >staging_replica_password_2024 ~* +@read +psync +replconf

# =============================================================================
# FUNCTION USER (for Redis Functions - Redis 7 feature)
# =============================================================================
user function_user on >staging_function_password_2024 ~* +@read +@write +@scripting +function +fcall +eval

# =============================================================================
# ACL CATEGORIES EXPLANATION
# =============================================================================
# @read      - Read commands (GET, MGET, etc.)
# @write     - Write commands (SET, MSET, etc.)
# @string    - String operations
# @hash      - Hash operations
# @list      - List operations
# @set       - Set operations
# @sortedset - Sorted set operations
# @stream    - Stream operations
# @pubsub    - Pub/Sub operations
# @scripting - Lua scripting and Redis Functions
# @connection- Connection management
# @transaction- Transaction commands
# @dangerous - Dangerous commands (FLUSHALL, SHUTDOWN, etc.)
# @all       - All commands

# =============================================================================
# KEY PATTERN EXPLANATION
# =============================================================================
# ~*           - Access to all keys
# ~cache:*     - Access only to keys starting with "cache:"
# ~session:*   - Access only to keys starting with "session:"
# ~test:*      - Access only to keys starting with "test:"
# ~user:*      - Access only to keys starting with "user:"

# =============================================================================
# CHANNEL PATTERN EXPLANATION
# =============================================================================
# &*           - Access to all pub/sub channels
# &channel:*   - Access only to channels starting with "channel:"

# =============================================================================
# STAGING-SPECIFIC NOTES
# =============================================================================
# 1. Passwords are simple for staging but should be complex in production
# 2. All users have specific roles and limited permissions
# 3. Default user is disabled for security
# 4. Test user has full access for testing purposes
# 5. Monitoring user can only read and get system information
# 6. Application users have access only to their specific key patterns